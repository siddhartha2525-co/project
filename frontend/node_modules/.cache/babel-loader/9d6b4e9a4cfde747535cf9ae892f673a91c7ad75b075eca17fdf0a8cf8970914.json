{"ast":null,"code":"import _objectSpread from\"/Users/adeshsiddharth123/project 1/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect,useCallback}from'react';import{useParams}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import{Camera,VideoOff,AlertCircle}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const StudentSession=()=>{const{sessionId}=useParams();const{user}=useAuth();const videoRef=useRef(null);const canvasRef=useRef(null);const streamRef=useRef(null);const[isCameraOn,setIsCameraOn]=useState(false);const[isProcessing,setIsProcessing]=useState(false);const[connectionStatus,setConnectionStatus]=useState('disconnected');const[engagementMetrics,setEngagementMetrics]=useState({currentEmotion:'neutral',confidence:0,engagementScore:0,sessionDuration:0});const[alerts,setAlerts]=useState([]);const[sessionStartTime]=useState(Date.now());// Start webcam with simplified approach\nconst startCamera=useCallback(async()=>{try{setConnectionStatus('connecting');setAlerts(prev=>[...prev.slice(-2),'Starting camera...']);// Check if getUserMedia is supported\nif(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){throw new Error('Camera API not supported in this browser');}// Use simple constraints that work on most devices\nconst stream=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640,min:320},height:{ideal:480,min:240},facingMode:'user'},audio:false});console.log('Camera stream obtained:',stream);if(videoRef.current){console.log('Video element found, setting srcObject...');// Set the stream as the video source\nvideoRef.current.srcObject=stream;// Wait for the video to be ready\nvideoRef.current.onloadedmetadata=()=>{console.log('Video metadata loaded');if(videoRef.current){console.log('Video dimensions:',videoRef.current.videoWidth,'x',videoRef.current.videoHeight);videoRef.current.play().then(()=>{console.log('Video playback started successfully');setConnectionStatus('connected');setAlerts(prev=>[...prev.slice(-2),'Camera started successfully!']);}).catch(playError=>{console.error('Error playing video:',playError);setAlerts(prev=>[...prev.slice(-2),'Error starting video playback']);});}};videoRef.current.oncanplay=()=>{console.log('Video can start playing');};videoRef.current.onerror=e=>{console.error('Video error event:',e);setAlerts(prev=>[...prev.slice(-2),'Video error occurred']);};streamRef.current=stream;setIsCameraOn(true);}else{console.error('Video element not found in startCamera');console.log('videoRef:',videoRef);console.log('videoRef.current:',videoRef.current);throw new Error('Video element not found - ref is null or undefined');}}catch(error){console.error('Error accessing camera:',error);setConnectionStatus('disconnected');let errorMessage='Camera access denied. Please enable camera permissions.';if(error.name==='NotAllowedError'){errorMessage='Camera permission denied. Please allow camera access in your browser settings.';}else if(error.name==='NotFoundError'){errorMessage='No camera found. Please connect a camera and try again.';}else if(error.name==='NotSupportedError'){errorMessage='Camera not supported in this browser. Please use a modern browser.';}else if(error.name==='NotReadableError'){errorMessage='Camera is in use by another application. Please close other apps using the camera.';}setAlerts(prev=>[...prev.slice(-2),errorMessage]);}},[]);// Stop webcam\nconst stopCamera=useCallback(()=>{if(streamRef.current){streamRef.current.getTracks().forEach(track=>track.stop());streamRef.current=null;}if(videoRef.current){videoRef.current.srcObject=null;}setIsCameraOn(false);setConnectionStatus('disconnected');},[]);// Capture frame and send for processing\nconst captureAndProcessFrame=useCallback(async()=>{if(!videoRef.current||!canvasRef.current||!isCameraOn||isProcessing)return;try{setIsProcessing(true);// Capture frame from video\nconst canvas=canvasRef.current;const context=canvas.getContext('2d');if(!context)return;// Get video dimensions\nconst videoWidth=videoRef.current.videoWidth;const videoHeight=videoRef.current.videoHeight;// Set canvas dimensions to match video\ncanvas.width=videoWidth;canvas.height=videoHeight;// Clear canvas and draw video frame\ncontext.clearRect(0,0,canvas.width,canvas.height);context.drawImage(videoRef.current,0,0,videoWidth,videoHeight);// Convert to blob and send to backend\ncanvas.toBlob(async blob=>{var _user$id;if(!blob){setIsProcessing(false);return;}const formData=new FormData();formData.append('frame',blob);formData.append('studentId',(user===null||user===void 0?void 0:(_user$id=user.id)===null||_user$id===void 0?void 0:_user$id.toString())||'');formData.append('sessionId',sessionId||'');try{const response=await fetch('http://localhost:5002/api/metrics/process-frame',{method:'POST',body:formData});if(response.ok){const data=await response.json();updateEngagementMetrics(data);}else{console.error('Frame processing failed:',response.status);}}catch(error){console.error('Error processing frame:',error);}finally{setIsProcessing(false);}},'image/jpeg',0.8);}catch(error){console.error('Error capturing frame:',error);setIsProcessing(false);}},[isCameraOn,isProcessing,user===null||user===void 0?void 0:user.id,sessionId]);// Update engagement metrics\nconst updateEngagementMetrics=data=>{setEngagementMetrics(prev=>_objectSpread(_objectSpread({},prev),{},{currentEmotion:data.emotion||'neutral',confidence:data.confidence||0,engagementScore:data.engagementScore||prev.engagementScore,sessionDuration:Math.floor((Date.now()-sessionStartTime)/1000)}));// Generate alerts based on emotion\nif(data.emotion==='confused'&&data.confidence>0.7){setAlerts(prev=>[...prev.slice(-2),'You seem confused. Consider asking a question!']);}else if(data.emotion==='bored'&&data.confidence>0.7){setAlerts(prev=>[...prev.slice(-2),'Stay engaged! Try taking notes or asking questions.']);}};// Process frames at regular intervals\nuseEffect(()=>{if(!isCameraOn)return;const interval=setInterval(()=>{captureAndProcessFrame();},2000);// Process every 2 seconds\nreturn()=>clearInterval(interval);},[isCameraOn,captureAndProcessFrame]);// Update session duration\nuseEffect(()=>{const interval=setInterval(()=>{setEngagementMetrics(prev=>_objectSpread(_objectSpread({},prev),{},{sessionDuration:Math.floor((Date.now()-sessionStartTime)/1000)}));},1000);return()=>clearInterval(interval);},[sessionStartTime]);// Check camera permissions on mount\nuseEffect(()=>{const checkCameraPermissions=async()=>{try{if(navigator.permissions&&navigator.permissions.query){const permission=await navigator.permissions.query({name:'camera'});if(permission.state==='denied'){setAlerts(prev=>[...prev,'Camera permission denied. Please enable camera access in browser settings.']);}}}catch(error){console.log('Permission API not supported');}};checkCameraPermissions();// List available media devices for debugging\nif(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){navigator.mediaDevices.enumerateDevices().then(devices=>{const videoDevices=devices.filter(device=>device.kind==='videoinput');console.log('Available video devices:',videoDevices);if(videoDevices.length===0){setAlerts(prev=>[...prev,'No camera devices found. Please connect a camera.']);}}).catch(console.error);}},[]);// Cleanup on unmount\nuseEffect(()=>{return()=>{stopCamera();};},[stopCamera]);const formatTime=seconds=>{const mins=Math.floor(seconds/60);const secs=seconds%60;return\"\".concat(mins,\":\").concat(secs.toString().padStart(2,'0'));};const getEmotionColor=emotion=>{switch(emotion){case'attentive':return'text-green-600';case'confused':return'text-yellow-600';case'bored':return'text-red-600';case'happy':return'text-blue-600';default:return'text-gray-600';}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Online Class Session\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Session ID: \",sessionId]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900\",children:user===null||user===void 0?void 0:user.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 capitalize\",children:user===null||user===void 0?void 0:user.role})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 rounded-full \".concat(connectionStatus==='connected'?'bg-green-500':connectionStatus==='connecting'?'bg-yellow-500':'bg-red-500')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600 capitalize\",children:connectionStatus})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900\",children:\"Your Camera Feed\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:isCameraOn?stopCamera:startCamera,className:\"px-4 py-2 rounded-lg font-medium transition-colors \".concat(isCameraOn?'bg-red-600 text-white hover:bg-red-700':'bg-green-600 text-white hover:bg-green-700'),children:isCameraOn?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(VideoOff,{className:\"w-4 h-4 inline mr-2\"}),\"Stop Camera\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Camera,{className:\"w-4 h-4 inline mr-2\"}),\"Start Camera\"]})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('Video element:',videoRef.current);console.log('Stream:',streamRef.current);console.log('Camera state:',isCameraOn);console.log('Connection status:',connectionStatus);if(videoRef.current){console.log('Video dimensions:',videoRef.current.videoWidth,'x',videoRef.current.videoHeight);console.log('Video ready state:',videoRef.current.readyState);}},className:\"px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm\",title:\"Debug camera info\",children:\"Debug\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{try{const devices=await navigator.mediaDevices.enumerateDevices();const videoDevices=devices.filter(device=>device.kind==='videoinput');console.log('Available video devices:',videoDevices);if(videoDevices.length>0){setAlerts(prev=>[...prev.slice(-2),\"Found \".concat(videoDevices.length,\" camera(s): \").concat(videoDevices.map(d=>d.label||'Unknown').join(', '))]);}else{setAlerts(prev=>[...prev.slice(-2),'No camera devices found!']);}}catch(error){console.error('Error enumerating devices:',error);setAlerts(prev=>[...prev.slice(-2),'Error checking camera devices']);}},className:\"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm\",title:\"Test camera devices\",children:\"Test Cameras\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(videoRef.current&&isCameraOn){const video=videoRef.current;console.log('Video element state:');console.log('- srcObject:',video.srcObject);console.log('- videoWidth:',video.videoWidth);console.log('- videoHeight:',video.videoHeight);console.log('- readyState:',video.readyState);console.log('- paused:',video.paused);console.log('- ended:',video.ended);console.log('- currentTime:',video.currentTime);console.log('- duration:',video.duration);// Try to force a refresh\nvideo.load();setAlerts(prev=>[...prev.slice(-2),'Video element refreshed. Check console for details.']);}else{setAlerts(prev=>[...prev.slice(-2),'Camera must be on to test video display']);}},className:\"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm\",title:\"Test video display\",children:\"Test Video\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative bg-black rounded-lg overflow-hidden\",children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true,playsInline:true,muted:true,controls:false,className:\"w-full h-96 object-cover \".concat(!isCameraOn?'hidden':''),style:{transform:'scaleX(-1)'}// Mirror effect for selfie view\n,onError:e=>{console.error('Video error:',e);setAlerts(prev=>[...prev.slice(-2),'Video playback error. Please try again.']);},onLoadedData:()=>{console.log('Video loaded successfully');if(videoRef.current){console.log('Video dimensions:',videoRef.current.videoWidth,'x',videoRef.current.videoHeight);}},onCanPlay:()=>{console.log('Video can play');if(videoRef.current){console.log('Final video dimensions:',videoRef.current.videoWidth,'x',videoRef.current.videoHeight);}},onLoadedMetadata:()=>{console.log('Video metadata loaded in element');},onPlay:()=>{console.log('Video is playing');setAlerts(prev=>[...prev.slice(-2),'Video is now playing!']);}}),!isCameraOn&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-white\",children:[/*#__PURE__*/_jsx(Camera,{className:\"w-16 h-16 mx-auto mb-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-medium\",children:\"Camera is off\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Click \\\"Start Camera\\\" to begin\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-3 bg-gray-800 rounded-lg max-w-sm mx-auto\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-300 mb-2\",children:\"\\uD83D\\uDCA1 Troubleshooting:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-xs text-gray-400 text-left space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Allow camera permissions when prompted\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Check if camera is not in use by other apps\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Try refreshing the page if camera doesn't start\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Use Chrome/Firefox/Safari for best compatibility\"})]})]})]})}),isProcessing&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-4 right-4 bg-blue-600 text-white px-3 py-1 rounded-full text-sm\",children:\"Processing...\"}),isCameraOn&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-4 left-4 bg-black bg-opacity-70 text-white px-3 py-1 rounded-full text-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Live\"})]})}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,className:\"hidden\"})]}),isCameraOn&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 p-4 bg-blue-50 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-blue-700\",children:isProcessing?'Processing frame...':'Ready for next frame'})]})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Current Emotion\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl font-bold mb-2 \".concat(getEmotionColor(engagementMetrics.currentEmotion)),children:engagementMetrics.currentEmotion.charAt(0).toUpperCase()+engagementMetrics.currentEmotion.slice(1)}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"Confidence: \",(engagementMetrics.confidence*100).toFixed(1),\"%\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Engagement Score\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-4xl font-bold text-blue-600 mb-2\",children:[engagementMetrics.engagementScore,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-2 rounded-full transition-all duration-300\",style:{width:\"\".concat(engagementMetrics.engagementScore,\"%\")}})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Session Info\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Duration:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:formatTime(engagementMetrics.sessionDuration)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs font-medium \".concat(connectionStatus==='connected'?'bg-green-100 text-green-800':connectionStatus==='connecting'?'bg-yellow-100 text-yellow-800':'bg-red-100 text-red-800'),children:connectionStatus})]})]})]}),alerts.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5 mr-2 text-yellow-500\"}),\"Alerts\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:alerts.map((alert,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-yellow-50 border border-yellow-200 rounded-lg\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-yellow-800\",children:alert})},index))})]})]})]})]})});};export default StudentSession;","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","useParams","useAuth","Camera","VideoOff","AlertCircle","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","StudentSession","sessionId","user","videoRef","canvasRef","streamRef","isCameraOn","setIsCameraOn","isProcessing","setIsProcessing","connectionStatus","setConnectionStatus","engagementMetrics","setEngagementMetrics","currentEmotion","confidence","engagementScore","sessionDuration","alerts","setAlerts","sessionStartTime","Date","now","startCamera","prev","slice","navigator","mediaDevices","getUserMedia","Error","stream","video","width","ideal","min","height","facingMode","audio","console","log","current","srcObject","onloadedmetadata","videoWidth","videoHeight","play","then","catch","playError","error","oncanplay","onerror","e","errorMessage","name","stopCamera","getTracks","forEach","track","stop","captureAndProcessFrame","canvas","context","getContext","clearRect","drawImage","toBlob","blob","_user$id","formData","FormData","append","id","toString","response","fetch","method","body","ok","data","json","updateEngagementMetrics","status","_objectSpread","emotion","Math","floor","interval","setInterval","clearInterval","checkCameraPermissions","permissions","query","permission","state","enumerateDevices","devices","videoDevices","filter","device","kind","length","formatTime","seconds","mins","secs","concat","padStart","getEmotionColor","className","children","role","onClick","readyState","title","map","d","label","join","paused","ended","currentTime","duration","load","ref","autoPlay","playsInline","muted","controls","style","transform","onError","onLoadedData","onCanPlay","onLoadedMetadata","onPlay","charAt","toUpperCase","toFixed","alert","index"],"sources":["/Users/adeshsiddharth123/project 1/frontend/src/components/StudentSession.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport { Camera, Video, VideoOff, AlertCircle, TrendingUp, Users } from 'lucide-react';\n\ninterface EmotionData {\n  emotion: string;\n  confidence: number;\n  timestamp: string;\n}\n\ninterface EngagementMetrics {\n  currentEmotion: string;\n  confidence: number;\n  engagementScore: number;\n  sessionDuration: number;\n}\n\nconst StudentSession: React.FC = () => {\n  const { sessionId } = useParams<{ sessionId: string }>();\n  const { user } = useAuth();\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const streamRef = useRef<MediaStream | null>(null);\n  \n  const [isCameraOn, setIsCameraOn] = useState(false);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [connectionStatus, setConnectionStatus] = useState<'disconnected' | 'connecting' | 'connected'>('disconnected');\n  const [engagementMetrics, setEngagementMetrics] = useState<EngagementMetrics>({\n    currentEmotion: 'neutral',\n    confidence: 0,\n    engagementScore: 0,\n    sessionDuration: 0\n  });\n  const [alerts, setAlerts] = useState<string[]>([]);\n  const [sessionStartTime] = useState(Date.now());\n\n  // Start webcam with simplified approach\n  const startCamera = useCallback(async () => {\n    try {\n      setConnectionStatus('connecting');\n      setAlerts(prev => [...prev.slice(-2), 'Starting camera...']);\n      \n      // Check if getUserMedia is supported\n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        throw new Error('Camera API not supported in this browser');\n      }\n\n      // Use simple constraints that work on most devices\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: { ideal: 640, min: 320 },\n          height: { ideal: 480, min: 240 },\n          facingMode: 'user'\n        },\n        audio: false\n      });\n\n      console.log('Camera stream obtained:', stream);\n      \n      if (videoRef.current) {\n        console.log('Video element found, setting srcObject...');\n        // Set the stream as the video source\n        videoRef.current.srcObject = stream;\n        \n        // Wait for the video to be ready\n        videoRef.current.onloadedmetadata = () => {\n          console.log('Video metadata loaded');\n          if (videoRef.current) {\n            console.log('Video dimensions:', videoRef.current.videoWidth, 'x', videoRef.current.videoHeight);\n            videoRef.current.play().then(() => {\n              console.log('Video playback started successfully');\n              setConnectionStatus('connected');\n              setAlerts(prev => [...prev.slice(-2), 'Camera started successfully!']);\n            }).catch((playError) => {\n              console.error('Error playing video:', playError);\n              setAlerts(prev => [...prev.slice(-2), 'Error starting video playback']);\n            });\n          }\n        };\n\n        videoRef.current.oncanplay = () => {\n          console.log('Video can start playing');\n        };\n\n        videoRef.current.onerror = (e) => {\n          console.error('Video error event:', e);\n          setAlerts(prev => [...prev.slice(-2), 'Video error occurred']);\n        };\n\n        streamRef.current = stream;\n        setIsCameraOn(true);\n      } else {\n        console.error('Video element not found in startCamera');\n        console.log('videoRef:', videoRef);\n        console.log('videoRef.current:', videoRef.current);\n        throw new Error('Video element not found - ref is null or undefined');\n      }\n    } catch (error: any) {\n      console.error('Error accessing camera:', error);\n      setConnectionStatus('disconnected');\n      \n      let errorMessage = 'Camera access denied. Please enable camera permissions.';\n      if (error.name === 'NotAllowedError') {\n        errorMessage = 'Camera permission denied. Please allow camera access in your browser settings.';\n      } else if (error.name === 'NotFoundError') {\n        errorMessage = 'No camera found. Please connect a camera and try again.';\n      } else if (error.name === 'NotSupportedError') {\n        errorMessage = 'Camera not supported in this browser. Please use a modern browser.';\n      } else if (error.name === 'NotReadableError') {\n        errorMessage = 'Camera is in use by another application. Please close other apps using the camera.';\n      }\n      \n      setAlerts(prev => [...prev.slice(-2), errorMessage]);\n    }\n  }, []);\n\n  // Stop webcam\n  const stopCamera = useCallback(() => {\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n      streamRef.current = null;\n    }\n    if (videoRef.current) {\n      videoRef.current.srcObject = null;\n    }\n    setIsCameraOn(false);\n    setConnectionStatus('disconnected');\n  }, []);\n\n  // Capture frame and send for processing\n  const captureAndProcessFrame = useCallback(async () => {\n    if (!videoRef.current || !canvasRef.current || !isCameraOn || isProcessing) return;\n\n    try {\n      setIsProcessing(true);\n      \n      // Capture frame from video\n      const canvas = canvasRef.current;\n      const context = canvas.getContext('2d');\n      if (!context) return;\n\n      // Get video dimensions\n      const videoWidth = videoRef.current.videoWidth;\n      const videoHeight = videoRef.current.videoHeight;\n      \n      // Set canvas dimensions to match video\n      canvas.width = videoWidth;\n      canvas.height = videoHeight;\n      \n      // Clear canvas and draw video frame\n      context.clearRect(0, 0, canvas.width, canvas.height);\n      context.drawImage(videoRef.current, 0, 0, videoWidth, videoHeight);\n\n      // Convert to blob and send to backend\n      canvas.toBlob(async (blob) => {\n        if (!blob) {\n          setIsProcessing(false);\n          return;\n        }\n\n        const formData = new FormData();\n        formData.append('frame', blob);\n        formData.append('studentId', user?.id?.toString() || '');\n        formData.append('sessionId', sessionId || '');\n\n        try {\n          const response = await fetch('http://localhost:5002/api/metrics/process-frame', {\n            method: 'POST',\n            body: formData,\n          });\n\n          if (response.ok) {\n            const data = await response.json();\n            updateEngagementMetrics(data);\n          } else {\n            console.error('Frame processing failed:', response.status);\n          }\n        } catch (error) {\n          console.error('Error processing frame:', error);\n        } finally {\n          setIsProcessing(false);\n        }\n      }, 'image/jpeg', 0.8);\n\n    } catch (error) {\n      console.error('Error capturing frame:', error);\n      setIsProcessing(false);\n    }\n  }, [isCameraOn, isProcessing, user?.id, sessionId]);\n\n  // Update engagement metrics\n  const updateEngagementMetrics = (data: any) => {\n    setEngagementMetrics(prev => ({\n      ...prev,\n      currentEmotion: data.emotion || 'neutral',\n      confidence: data.confidence || 0,\n      engagementScore: data.engagementScore || prev.engagementScore,\n      sessionDuration: Math.floor((Date.now() - sessionStartTime) / 1000)\n    }));\n\n    // Generate alerts based on emotion\n    if (data.emotion === 'confused' && data.confidence > 0.7) {\n      setAlerts(prev => [...prev.slice(-2), 'You seem confused. Consider asking a question!']);\n    } else if (data.emotion === 'bored' && data.confidence > 0.7) {\n      setAlerts(prev => [...prev.slice(-2), 'Stay engaged! Try taking notes or asking questions.']);\n    }\n  };\n\n  // Process frames at regular intervals\n  useEffect(() => {\n    if (!isCameraOn) return;\n\n    const interval = setInterval(() => {\n      captureAndProcessFrame();\n    }, 2000); // Process every 2 seconds\n\n    return () => clearInterval(interval);\n  }, [isCameraOn, captureAndProcessFrame]);\n\n  // Update session duration\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setEngagementMetrics(prev => ({\n        ...prev,\n        sessionDuration: Math.floor((Date.now() - sessionStartTime) / 1000)\n      }));\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [sessionStartTime]);\n\n  // Check camera permissions on mount\n  useEffect(() => {\n    const checkCameraPermissions = async () => {\n      try {\n        if (navigator.permissions && navigator.permissions.query) {\n          const permission = await navigator.permissions.query({ name: 'camera' as PermissionName });\n          if (permission.state === 'denied') {\n            setAlerts(prev => [...prev, 'Camera permission denied. Please enable camera access in browser settings.']);\n          }\n        }\n      } catch (error) {\n        console.log('Permission API not supported');\n      }\n    };\n    \n    checkCameraPermissions();\n    \n    // List available media devices for debugging\n    if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\n      navigator.mediaDevices.enumerateDevices()\n        .then(devices => {\n          const videoDevices = devices.filter(device => device.kind === 'videoinput');\n          console.log('Available video devices:', videoDevices);\n          if (videoDevices.length === 0) {\n            setAlerts(prev => [...prev, 'No camera devices found. Please connect a camera.']);\n          }\n        })\n        .catch(console.error);\n    }\n  }, []);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      stopCamera();\n    };\n  }, [stopCamera]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const getEmotionColor = (emotion: string) => {\n    switch (emotion) {\n      case 'attentive': return 'text-green-600';\n      case 'confused': return 'text-yellow-600';\n      case 'bored': return 'text-red-600';\n      case 'happy': return 'text-blue-600';\n      default: return 'text-gray-600';\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-6\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"bg-white rounded-lg shadow-sm p-6 mb-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">Online Class Session</h1>\n              <p className=\"text-gray-600\">Session ID: {sessionId}</p>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"text-right\">\n                <p className=\"text-sm font-medium text-gray-900\">{user?.name}</p>\n                <p className=\"text-xs text-gray-500 capitalize\">{user?.role}</p>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <div className={`w-3 h-3 rounded-full ${\n                  connectionStatus === 'connected' ? 'bg-green-500' : \n                  connectionStatus === 'connecting' ? 'bg-yellow-500' : 'bg-red-500'\n                }`} />\n                <span className=\"text-sm text-gray-600 capitalize\">{connectionStatus}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Main Webcam Feed */}\n          <div className=\"lg:col-span-2\">\n            <div className=\"bg-white rounded-lg shadow-sm p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-lg font-semibold text-gray-900\">Your Camera Feed</h2>\n                <div className=\"flex space-x-2\">\n                  <button\n                    onClick={isCameraOn ? stopCamera : startCamera}\n                    className={`px-4 py-2 rounded-lg font-medium transition-colors ${\n                      isCameraOn\n                        ? 'bg-red-600 text-white hover:bg-red-700'\n                        : 'bg-green-600 text-white hover:bg-green-700'\n                    }`}\n                  >\n                    {isCameraOn ? (\n                      <>\n                        <VideoOff className=\"w-4 h-4 inline mr-2\" />\n                        Stop Camera\n                      </>\n                    ) : (\n                      <>\n                        <Camera className=\"w-4 h-4 inline mr-2\" />\n                        Start Camera\n                      </>\n                    )}\n                  </button>\n                  \n                  {/* Debug button for troubleshooting */}\n                  <button\n                    onClick={() => {\n                      console.log('Video element:', videoRef.current);\n                      console.log('Stream:', streamRef.current);\n                      console.log('Camera state:', isCameraOn);\n                      console.log('Connection status:', connectionStatus);\n                      if (videoRef.current) {\n                        console.log('Video dimensions:', videoRef.current.videoWidth, 'x', videoRef.current.videoHeight);\n                        console.log('Video ready state:', videoRef.current.readyState);\n                      }\n                    }}\n                    className=\"px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm\"\n                    title=\"Debug camera info\"\n                  >\n                    Debug\n                  </button>\n                  \n                  {/* Test camera button */}\n                  <button\n                    onClick={async () => {\n                      try {\n                        const devices = await navigator.mediaDevices.enumerateDevices();\n                        const videoDevices = devices.filter(device => device.kind === 'videoinput');\n                        console.log('Available video devices:', videoDevices);\n                        \n                        if (videoDevices.length > 0) {\n                          setAlerts(prev => [...prev.slice(-2), `Found ${videoDevices.length} camera(s): ${videoDevices.map(d => d.label || 'Unknown').join(', ')}`]);\n                        } else {\n                          setAlerts(prev => [...prev.slice(-2), 'No camera devices found!']);\n                        }\n                      } catch (error) {\n                        console.error('Error enumerating devices:', error);\n                        setAlerts(prev => [...prev.slice(-2), 'Error checking camera devices']);\n                      }\n                    }}\n                    className=\"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm\"\n                    title=\"Test camera devices\"\n                  >\n                    Test Cameras\n                  </button>\n                  \n                  {/* Test video display button */}\n                  <button\n                    onClick={() => {\n                      if (videoRef.current && isCameraOn) {\n                        const video = videoRef.current;\n                        console.log('Video element state:');\n                        console.log('- srcObject:', video.srcObject);\n                        console.log('- videoWidth:', video.videoWidth);\n                        console.log('- videoHeight:', video.videoHeight);\n                        console.log('- readyState:', video.readyState);\n                        console.log('- paused:', video.paused);\n                        console.log('- ended:', video.ended);\n                        console.log('- currentTime:', video.currentTime);\n                        console.log('- duration:', video.duration);\n                        \n                        // Try to force a refresh\n                        video.load();\n                        setAlerts(prev => [...prev.slice(-2), 'Video element refreshed. Check console for details.']);\n                      } else {\n                        setAlerts(prev => [...prev.slice(-2), 'Camera must be on to test video display']);\n                      }\n                    }}\n                    className=\"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm\"\n                    title=\"Test video display\"\n                  >\n                    Test Video\n                  </button>\n                </div>\n              </div>\n\n              {/* Video Container */}\n              <div className=\"relative bg-black rounded-lg overflow-hidden\">\n                {/* Always render video element but hide when camera is off */}\n                <video\n                  ref={videoRef}\n                  autoPlay\n                  playsInline\n                  muted\n                  controls={false}\n                  className={`w-full h-96 object-cover ${!isCameraOn ? 'hidden' : ''}`}\n                  style={{ transform: 'scaleX(-1)' }} // Mirror effect for selfie view\n                  onError={(e) => {\n                    console.error('Video error:', e);\n                    setAlerts(prev => [...prev.slice(-2), 'Video playback error. Please try again.']);\n                  }}\n                  onLoadedData={() => {\n                    console.log('Video loaded successfully');\n                    if (videoRef.current) {\n                      console.log('Video dimensions:', videoRef.current.videoWidth, 'x', videoRef.current.videoHeight);\n                    }\n                  }}\n                  onCanPlay={() => {\n                    console.log('Video can play');\n                    if (videoRef.current) {\n                      console.log('Final video dimensions:', videoRef.current.videoWidth, 'x', videoRef.current.videoHeight);\n                    }\n                  }}\n                  onLoadedMetadata={() => {\n                    console.log('Video metadata loaded in element');\n                  }}\n                  onPlay={() => {\n                    console.log('Video is playing');\n                    setAlerts(prev => [...prev.slice(-2), 'Video is now playing!']);\n                  }}\n                />\n                \n                {/* Overlay when camera is off */}\n                {!isCameraOn && (\n                  <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <div className=\"text-center text-white\">\n                      <Camera className=\"w-16 h-16 mx-auto mb-4 text-gray-400\" />\n                      <p className=\"text-lg font-medium\">Camera is off</p>\n                      <p className=\"text-sm text-gray-400\">Click \"Start Camera\" to begin</p>\n                      \n                      {/* Camera troubleshooting tips */}\n                      <div className=\"mt-4 p-3 bg-gray-800 rounded-lg max-w-sm mx-auto\">\n                        <p className=\"text-xs text-gray-300 mb-2\">💡 Troubleshooting:</p>\n                        <ul className=\"text-xs text-gray-400 text-left space-y-1\">\n                          <li>• Allow camera permissions when prompted</li>\n                          <li>• Check if camera is not in use by other apps</li>\n                          <li>• Try refreshing the page if camera doesn't start</li>\n                          <li>• Use Chrome/Firefox/Safari for best compatibility</li>\n                        </ul>\n                      </div>\n                    </div>\n                  </div>\n                )}\n                \n                {isProcessing && (\n                  <div className=\"absolute top-4 right-4 bg-blue-600 text-white px-3 py-1 rounded-full text-sm\">\n                    Processing...\n                  </div>\n                )}\n                \n                {/* Camera status overlay */}\n                {isCameraOn && (\n                  <div className=\"absolute bottom-4 left-4 bg-black bg-opacity-70 text-white px-3 py-1 rounded-full text-sm\">\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n                      <span>Live</span>\n                    </div>\n                  </div>\n                )}\n                \n                <canvas ref={canvasRef} className=\"hidden\" />\n              </div>\n\n              {/* Processing Status */}\n              {isCameraOn && (\n                <div className=\"mt-4 p-4 bg-blue-50 rounded-lg\">\n                  <div className=\"flex items-center space-x-2\">\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\" />\n                    <span className=\"text-sm text-blue-700\">\n                      {isProcessing ? 'Processing frame...' : 'Ready for next frame'}\n                    </span>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Sidebar - Engagement Metrics */}\n          <div className=\"space-y-6\">\n            {/* Current Emotion */}\n            <div className=\"bg-white rounded-lg shadow-sm p-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Current Emotion</h3>\n              <div className=\"text-center\">\n                <div className={`text-4xl font-bold mb-2 ${getEmotionColor(engagementMetrics.currentEmotion)}`}>\n                  {engagementMetrics.currentEmotion.charAt(0).toUpperCase() + engagementMetrics.currentEmotion.slice(1)}\n                </div>\n                <p className=\"text-sm text-gray-600\">\n                  Confidence: {(engagementMetrics.confidence * 100).toFixed(1)}%\n                </p>\n              </div>\n            </div>\n\n            {/* Engagement Score */}\n            <div className=\"bg-white rounded-lg shadow-sm p-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Engagement Score</h3>\n              <div className=\"text-center\">\n                <div className=\"text-4xl font-bold text-blue-600 mb-2\">\n                  {engagementMetrics.engagementScore}%\n                </div>\n                <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                  <div \n                    className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                    style={{ width: `${engagementMetrics.engagementScore}%` }}\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Session Info */}\n            <div className=\"bg-white rounded-lg shadow-sm p-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Session Info</h3>\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm text-gray-600\">Duration:</span>\n                  <span className=\"font-medium\">{formatTime(engagementMetrics.sessionDuration)}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm text-gray-600\">Status:</span>\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                    connectionStatus === 'connected' ? 'bg-green-100 text-green-800' :\n                    connectionStatus === 'connecting' ? 'bg-yellow-100 text-yellow-800' :\n                    'bg-red-100 text-red-800'\n                  }`}>\n                    {connectionStatus}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {/* Alerts */}\n            {alerts.length > 0 && (\n              <div className=\"bg-white rounded-lg shadow-sm p-6\">\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n                  <AlertCircle className=\"w-5 h-5 mr-2 text-yellow-500\" />\n                  Alerts\n                </h3>\n                <div className=\"space-y-2\">\n                  {alerts.map((alert, index) => (\n                    <div key={index} className=\"p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\n                      <p className=\"text-sm text-yellow-800\">{alert}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default StudentSession;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}